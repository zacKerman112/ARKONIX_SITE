<!DOCTYPE html>
<html lang="ru">
{% extends "base.html" %}   
{% block title %}–ó–∞—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º - ARKONIX{% endblock %}
{% block content %}
<head>
    <meta charset="UTF-8">
    <title>–ó–∞—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º - ARKONIX</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .payments-container {
            max-width: 1400px;
            margin: 100px auto 50px;
            padding: 20px;
        }

        .page-header {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 40px;
            box-shadow: 0 10px 40px rgba(16, 185, 129, 0.3);
        }

        .page-header h1 {
            margin: 0 0 10px 0;
            font-size: 2.5em;
            font-weight: 900;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            transition: 0.4s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #10b981;
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.3);
        }

        .stat-card h3 {
            margin: 0;
            font-size: 2.5em;
            color: #10b981;
            font-weight: 900;
        }

        .stat-card p {
            margin: 10px 0 0 0;
            color: #cbd5f5;
        }

        .section {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .section h2 {
            margin: 0 0 20px 0;
            color: #10b981;
            font-size: 1.8em;
            font-weight: 800;
        }

        /* –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã */
        .search-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(2, 6, 23, 0.8);
            color: #e5e7eb;
            font-size: 1em;
            transition: 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
            pointer-events: none;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 12px 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(2, 6, 23, 0.8);
            color: #94a3b8;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
        }

        .filter-btn:hover {
            border-color: #10b981;
            color: #10b981;
        }

        .filter-btn.active {
            background: linear-gradient(90deg, #10b981, #059669);
            border-color: #10b981;
            color: white;
        }

        .staff-count {
            padding: 12px 20px;
            background: rgba(56, 189, 248, 0.1);
            border: 1px solid rgba(56, 189, 248, 0.3);
            border-radius: 12px;
            color: #38bdf8;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* –°–µ—Ç–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ */
        .staff-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .staff-card {
            background: rgba(2, 6, 23, 0.6);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: 0.3s;
            position: relative;
        }

        .staff-card:hover {
            border-color: #10b981;
            transform: translateY(-3px);
        }

        .staff-card.hidden {
            display: none;
        }

        .staff-status-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 0.75em;
            font-weight: 700;
        }

        .status-approved {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .status-pending {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .staff-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            padding-right: 80px;
        }

        .staff-info {
            flex: 1;
        }

        .staff-name {
            font-size: 1.2em;
            font-weight: 700;
            color: #e5e7eb;
            margin-bottom: 5px;
        }

        .staff-position {
            color: #94a3b8;
            font-size: 0.9em;
        }

        .staff-earned {
            font-size: 1.5em;
            color: #10b981;
            font-weight: 900;
            text-align: right;
        }

        .staff-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            font-size: 0.85em;
            color: #64748b;
        }

        .staff-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .pay-form {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .pay-input {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(2, 6, 23, 0.8);
            color: #e5e7eb;
            transition: 0.3s;
        }

        .pay-input:focus {
            outline: none;
            border-color: #10b981;
        }

        .pay-btn {
            padding: 10px 20px;
            background: linear-gradient(90deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
            white-space: nowrap;
        }

        .pay-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .pay-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π */
        .payment-item {
            background: rgba(2, 6, 23, 0.6);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 15px;
            transition: 0.3s;
        }

        .payment-item:hover {
            border-color: #10b981;
        }

        .payment-item.hidden {
            display: none;
        }

        .payment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .payment-staff {
            font-size: 1.1em;
            font-weight: 700;
            color: #e5e7eb;
        }

        .payment-amount {
            font-size: 1.3em;
            color: #10b981;
            font-weight: 900;
        }

        .payment-meta {
            display: flex;
            gap: 15px;
            color: #94a3b8;
            font-size: 0.9em;
            flex-wrap: wrap;
        }

        .payment-description {
            background: rgba(16, 185, 129, 0.1);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            color: #cbd5f5;
            border-left: 3px solid #10b981;
        }

        /* –¢–æ–ø —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ */
        .top-earners {
            display: grid;
            gap: 15px;
        }

        .earner-item {
            background: rgba(2, 6, 23, 0.6);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: 0.3s;
        }

        .earner-item:hover {
            border-color: #10b981;
            transform: translateX(5px);
        }

        .earner-info {
            flex: 1;
        }

        .earner-name {
            font-weight: 700;
            color: #e5e7eb;
            font-size: 1.1em;
        }

        .earner-position {
            color: #94a3b8;
            font-size: 0.9em;
        }

        .earner-earned {
            font-size: 1.5em;
            color: #10b981;
            font-weight: 900;
        }

        /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        /* –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ */
        .btn-back {
            display: inline-block;
            padding: 12px 24px;
            background: rgba(56, 189, 248, 0.15);
            color: #38bdf8;
            text-decoration: none;
            border-radius: 10px;
            font-weight: 700;
            transition: 0.3s;
            border: 1px solid rgba(56, 189, 248, 0.3);
        }

        .btn-back:hover {
            background: rgba(56, 189, 248, 0.25);
            transform: translateX(-5px);
        }

        @media (max-width: 768px) {
            .search-controls {
                flex-direction: column;
            }

            .staff-grid {
                grid-template-columns: 1fr;
            }

            .pay-form {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="container header-container">
            <div class="logo">
                <a href="/" style="color: inherit; text-decoration: none;">ARKONIX</a>
            </div>
            <nav class="nav">
                <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/services">–£—Å–ª—É–≥–∏</a>
                <a href="/team">–ö–æ–º–∞–Ω–¥–∞</a>
            </nav>
            <div class="user-panel">
                <a href="/profile">–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a>
                <a href="/logout">–í—ã—Ö–æ–¥</a>
            </div>
        </div>
    </header>

    <div class="payments-container">
        <a href="/profile" class="btn-back"
            style="margin-bottom: 20px; display: inline-flex; align-items: center; gap: 8px;">
            ‚Üê –ù–∞–∑–∞–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
        </a>

        <div class="page-header">
            <h1>üíµ –ó–∞—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–ª–∞—Ç–∞–º–∏ –∫–æ–º–∞–Ω–¥–µ ARKONIX</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>{% if stats %}{{ stats.get('total_payments', 0) }}{% else %}0{% endif %}</h3>
                <p>–í—Å–µ–≥–æ –∑–∞—á–∏—Å–ª–µ–Ω–∏–π</p>
            </div>
            <div class="stat-card">
                <h3>{% if stats %}${{ "%.2f"|format(stats.get('total_amount', 0)) }}{% else %}$0.00{% endif %}</h3>
                <p>–û–±—â–∞—è —Å—É–º–º–∞</p>
            </div>
            <div class="stat-card">
                <h3>{% if stats %}${{ "%.2f"|format(stats.get('average_amount', 0)) }}{% else %}$0.00{% endif %}</h3>
                <p>–°—Ä–µ–¥–Ω—è—è –≤—ã–ø–ª–∞—Ç–∞</p>
            </div>
            <div class="stat-card">
                <h3>{% if staff_members %}{{ staff_members|length }}{% else %}0{% endif %}</h3>
                <p>–í—Å–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>
            </div>
        </div>

        <!-- –¢–æ–ø —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
        {% if top_earners and top_earners|length > 0 %}
        <div class="section">
            <h2>üèÜ –¢–æ–ø-5 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –∑–∞—Ä–∞–±–æ—Ç–∫—É</h2>
            <div class="top-earners">
                {% for earner in top_earners %}
                <div class="earner-item">
                    <div class="earner-info">
                        <div class="earner-name">{{ earner.first_name }} {{ earner.last_name }}</div>
                        <div class="earner-position">{{ earner.position }}</div>
                    </div>
                    <div class="earner-earned">${{ "%.2f"|format(earner.total_earned or 0) }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- –ó–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º -->
        <div class="section">
            <h2>‚ö° –ó–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º</h2>

            {% if staff_members and staff_members|length > 0 %}
            <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
            <div class="search-controls">
                <div class="search-box">
                    <input type="text" id="staffSearch" class="search-input"
                        placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏–ª–∏ email...">
                    <span class="search-icon">üîç</span>
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all">
                        üë• –í—Å–µ (<span id="countAll">{{ staff_members|length }}</span>)
                    </button>
                    <button class="filter-btn" data-filter="approved">
                        ‚úÖ –û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ (<span id="countApproved">{{ staff_members|selectattr('status', 'equalto',
                            'approved')|list|length }}</span>)
                    </button>
                    <button class="filter-btn" data-filter="pending">
                        ‚è≥ –û–∂–∏–¥–∞—é—Ç (<span id="countPending">{{ staff_members|selectattr('status', 'equalto',
                            'pending')|list|length }}</span>)
                    </button>
                </div>
                <div class="staff-count">
                    <span>–ü–æ–∫–∞–∑–∞–Ω–æ:</span>
                    <span id="visibleCount">{{ staff_members|length }}</span>
                </div>
            </div>

            <!-- –°–µ—Ç–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
            <div class="staff-grid" id="staffGrid">
                {% for member in staff_members %}
                <div class="staff-card" data-status="{{ member.status }}"
                    data-name="{{ member.first_name }} {{ member.last_name }}" data-position="{{ member.position }}"
                    data-email="{{ member.email if member.email else '' }}">

                    <span class="staff-status-badge status-{{ member.status }}">
                        {% if member.status == 'approved' %}
                        ‚úÖ –û–¥–æ–±—Ä–µ–Ω
                        {% else %}
                        ‚è≥ –û–∂–∏–¥–∞–µ—Ç
                        {% endif %}
                    </span>

                    <div class="staff-header">
                        <div class="staff-info">
                            <div class="staff-name">{{ member.first_name }} {{ member.last_name }}</div>
                            <div class="staff-position">üíº {{ member.position }}</div>
                        </div>
                        <div class="staff-earned">${{ "%.2f"|format(member.total_earned or 0) }}</div>
                    </div>

                    <div class="staff-meta">
                        <span>üÜî ID: {{ member.id }}</span>
                        {% if member.email %}
                        <span>‚úâÔ∏è {{ member.email }}</span>
                        {% endif %}
                        <span>üë§ @{{ member.username }}</span>
                    </div>

                    {% if member.status == 'approved' %}
                    <form action="/api/admin/staff/pay" method="POST" class="pay-form" data-member-id="{{ member.id }}"
                        onsubmit="return handlePay(event, this.dataset.memberId)">
                        <input type="hidden" name="member_id" value="{{ member.id }}">
                        <input type="number" name="amount" step="0.01" min="0.01" placeholder="üí∞ –°—É–º–º–∞"
                            class="pay-input" required>
                        <input type="text" name="description" placeholder="üí¨ –û–ø–∏—Å–∞–Ω–∏–µ" class="pay-input">
                        <button type="submit" class="pay-btn">üíµ –ó–∞—á–∏—Å–ª–∏—Ç—å</button>
                    </form>
                    {% else %}
                    <div style="text-align: center; padding: 15px; background: rgba(251, 191, 36, 0.1); 
                                border-radius: 8px; color: #fbbf24; border: 1px solid rgba(251, 191, 36, 0.3);">
                        ‚è≥ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ–∂–∏–¥–∞–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div class="empty-state" id="noResults" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã</p>
            </div>
            {% else %}
            <div class="empty-state">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                </svg>
                <h3>üë• –ù–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h3>
                <p>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É</p>
            </div>
            {% endif %}
        </div>

        <!-- –ò—Å—Ç–æ—Ä–∏—è –∑–∞—á–∏—Å–ª–µ–Ω–∏–π -->
        <div class="section">
            <h2>üìã –ò—Å—Ç–æ—Ä–∏—è –∑–∞—á–∏—Å–ª–µ–Ω–∏–π ({% if payments %}{{ payments|length }}{% else %}0{% endif %})</h2>

            {% if payments and payments|length > 0 %}
            <!-- –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ -->
            <div class="search-controls" style="margin-bottom: 20px;">
                <div class="search-box">
                    <input type="text" id="paymentSearch" class="search-input"
                        placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É, —Å—É–º–º–µ –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é...">
                    <span class="search-icon">üîç</span>
                </div>
            </div>

            <div id="paymentsList">
                {% for payment in payments %}
                <div class="payment-item" data-staff="{{ payment.first_name }} {{ payment.last_name }}"
                    data-description="{{ payment.description if payment.description else '' }}"
                    data-amount="{{ payment.amount }}">
                    <div class="payment-header">
                        <div class="payment-staff">
                            üë§ {{ payment.first_name }} {{ payment.last_name }}
                        </div>
                        <div class="payment-amount">+${{ "%.2f"|format(payment.amount) }}</div>
                    </div>
                    <div class="payment-meta">
                        <span>üíº {{ payment.position }}</span>
                        <span>üë§ –û—Ç: {{ payment.admin_username }}</span>
                        <span>üìÖ {{ payment.created_at[:16] if payment.created_at else '–ù–µ–¥–∞–≤–Ω–æ' }}</span>
                    </div>
                    {% if payment.description %}
                    <div class="payment-description">
                        üí¨ {{ payment.description }}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏ -->
            <div class="empty-state" id="noPaymentResults" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>
            </div>
            {% else %}
            <div class="empty-state">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                <h3>üì≠ –ü–æ–∫–∞ –Ω–µ—Ç –∑–∞—á–∏—Å–ª–µ–Ω–∏–π</h3>
                <p>–ò—Å—Ç–æ—Ä–∏—è –∑–∞—á–∏—Å–ª–µ–Ω–∏–π –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –≤—ã–ø–ª–∞—Ç—ã</p>
            </div>
            {% endif %}
        </div>
    </div>

    <footer class="footer">
        <div class="container footer-container">
            <div class="footer-section">
                <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                <p>–¢–µ–ª–µ—Ñ–æ–Ω: +38 095 713 66 14</p>
                <p>Email: itw23265@gmail.com</p>
            </div>
            <div class="footer-section">
                <h4>–°–æ—Ü—Å–µ—Ç–∏</h4>
                <a href="https://t.me/worldit23">Telegram</a><br>
                <a href="https://discord.gg/uKzRMmshnp">Discord</a>
            </div>
            <div class="footer-section">
                <a href="/terms">–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
                <a href="/privacy">–ü–æ–ª–∏—Ç–∏–∫–∞ –∏ –ø—Ä–∞–≤–∏–ª–∞</a>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2025 ARKONIX. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
        </div>
    </footer>

    <script>
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è
        async function handlePay(e, memberId) {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            const submitBtn = form.querySelector('button[type="submit"]');

            // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞...';

            try {
                const response = await fetch('/api/admin/staff/pay', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        member_id: parseInt(formData.get('member_id')),
                        amount: parseFloat(formData.get('amount')),
                        description: formData.get('description')
                    })
                });

                const data = await response.json();

                if (data.success) {
                    alert('‚úÖ ' + data.message);
                    location.reload();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞: ' + data.error);
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'üíµ –ó–∞—á–∏—Å–ª–∏—Ç—å';
                }
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = 'üíµ –ó–∞—á–∏—Å–ª–∏—Ç—å';
            }

            return false;
        }

        // –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        const staffSearch = document.getElementById('staffSearch');
        const staffGrid = document.getElementById('staffGrid');
        const staffCards = staffGrid ? staffGrid.querySelectorAll('.staff-card') : [];
        const filterButtons = document.querySelectorAll('.filter-btn');
        const noResults = document.getElementById('noResults');
        const visibleCount = document.getElementById('visibleCount');

        let currentFilter = 'all';

        // –§—É–Ω–∫—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
        function filterStaff() {
            if (!staffSearch || !staffGrid || staffCards.length === 0) return;

            const searchTerm = staffSearch.value.toLowerCase();
            let visibleCards = 0;

            staffCards.forEach(card => {
                const status = card.dataset.status || '';
                const name = (card.dataset.name || '').toLowerCase();
                const position = (card.dataset.position || '').toLowerCase();
                const email = (card.dataset.email || '').toLowerCase();

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞
                const matchesFilter = currentFilter === 'all' || status === currentFilter;

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∏—Å–∫–∞
                const matchesSearch = searchTerm === '' ||
                    name.includes(searchTerm) ||
                    position.includes(searchTerm) ||
                    email.includes(searchTerm);

                if (matchesFilter && matchesSearch) {
                    card.classList.remove('hidden');
                    visibleCards++;
                } else {
                    card.classList.add('hidden');
                }
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
            if (visibleCards === 0) {
                if (noResults) noResults.style.display = 'block';
                if (staffGrid) staffGrid.style.display = 'none';
            } else {
                if (noResults) noResults.style.display = 'none';
                if (staffGrid) staffGrid.style.display = 'grid';
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
            if (visibleCount) visibleCount.textContent = visibleCards;
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞
        if (staffSearch) {
            staffSearch.addEventListener('input', filterStaff);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        filterButtons.forEach(btn => {
            btn.addEventListener('click', function () {
                // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                filterButtons.forEach(b => b.classList.remove('active'));
                // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –Ω–∞ –Ω–∞–∂–∞—Ç—É—é –∫–Ω–æ–ø–∫—É
                this.classList.add('active');

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ñ–∏–ª—å—Ç—Ä
                currentFilter = this.dataset.filter;

                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é
                filterStaff();
            });
        });

        // –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π
        const paymentSearch = document.getElementById('paymentSearch');
        const paymentsList = document.getElementById('paymentsList');
        const paymentItems = paymentsList ? paymentsList.querySelectorAll('.payment-item') : [];
        const noPaymentResults = document.getElementById('noPaymentResults');

        if (paymentSearch && paymentItems.length > 0) {
            paymentSearch.addEventListener('input', function () {
                const searchTerm = this.value.toLowerCase();
                let visiblePayments = 0;

                paymentItems.forEach(item => {
                    const staff = (item.dataset.staff || '').toLowerCase();
                    const description = (item.dataset.description || '').toLowerCase();
                    const amount = item.dataset.amount || '';

                    const matchesSearch = searchTerm === '' ||
                        staff.includes(searchTerm) ||
                        description.includes(searchTerm) ||
                        amount.includes(searchTerm);

                    if (matchesSearch) {
                        item.classList.remove('hidden');
                        visiblePayments++;
                    } else {
                        item.classList.add('hidden');
                    }
                });

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
                if (visiblePayments === 0 && paymentItems.length > 0) {
                    if (noPaymentResults) noPaymentResults.style.display = 'block';
                    if (paymentsList) paymentsList.style.display = 'none';
                } else {
                    if (noPaymentResults) noPaymentResults.style.display = 'none';
                    if (paymentsList) paymentsList.style.display = 'block';
                }
            });
        }
    </script>
</body>

</html>